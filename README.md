# ğŸ¦ Windows Service â€“ BCCR Exchange Rate Updater

This is a **configurable and self-initializing Windows Service**, developed in **C#** with support for **.NET Framework 4.7.2** and **.NET Core/.NET 6+**, designed to **automatically retrieve and store official exchange rate data** from the **Central Bank of Costa Rica (BCCR)**.

## ğŸ“Œ Purpose

The service automates the daily process of retrieving **buy and sell exchange rates** from BCCR's API and storing them in a customizable SQL Server table. It is ideal for financial systems, ERP platforms, or POS solutions that require accurate and official exchange rate information.

## âš™ï¸ Key Features

- âœ… Supports both `.NET Framework` and `.NET Core/.NET 6+`
- ğŸ” **Automatic execution** at a scheduled time (default: 8:00 a.m.)
- ğŸ§  **Self-initializing**: Automatically creates the `PARAMETROS` table if missing
- ğŸ§© **Fully configurable** target table and column mappings (e.g., `Fecha`, `Moneda`, `Compra`, `Venta`)
- ğŸ” **Prevents duplicate entries** by checking existing records by date
- ğŸ“¨ Retrieves both **buy and sell rates** in a single API request
- ğŸ“ Integrated with **log4net** for logging and error tracking
- ğŸ§¬ Designed for easy integration with new or existing systems

## ğŸ› ï¸ Technologies Used

- C# (.NET Framework 4.7.2 / .NET Core / .NET 6+)
- SQL Server
- Windows Services
- HttpClient & XML Parsing
- log4net

## ğŸ§© Configuration

The service reads execution settings and database mappings from a SQL Server table called `PARAMETROS`. If the table does not exist, it is created automatically with default values.

| Parameter Name     | Description                                      |
|--------------------|--------------------------------------------------|
| `API_URL`          | BCCR API endpoint                                |
| `API_TOKEN`        | Access token if required                         |
| `API_CORREO`       | Registered contact email                         |
| `API_NOMBRE`       | Registered name                                  |
| `TABLA_DESTINO`    | Name of the table to store exchange rates        |
| `COLUMNA_FECHA`    | Column for the exchange date                     |
| `COLUMNA_MONEDA`   | Column for the currency code (e.g., CRC)         |
| `COLUMNA_COMPRA`   | Column for the buy rate                          |
| `COLUMNA_VENTA`    | Column for the sell rate                         |
| `HORA_EJECUCION`   | Time to execute daily (e.g., `08:00`)            |

## ğŸ“¦ Example: Destination Table

```sql
CREATE TABLE TipoCambio (
    Id INT IDENTITY PRIMARY KEY,
    Fecha DATE NOT NULL,
    Moneda VARCHAR(3),
    Compra DECIMAL(10,4),
    Venta DECIMAL(10,4)
);
```

## ğŸš€ Installation & Usage

1. Clone this repository.
2. Open the solution in Visual Studio.
3. Update the connection string in `App.config` or `appsettings.json`.
4. Build the project and install the service using the command:
   ```bash
   sc create TipoCambioService binPath= "C:\Path\To\Executable.exe"
   ```
5. Start the service:
   ```bash
   sc start TipoCambioService
   ```
6. Review logs generated by log4net for activity and errors.

## ğŸ” Licensing

ğŸ”’ **This project is proprietary. It is not open-source.**  
Unauthorized copying, modification, or distribution is strictly prohibited.  
For commercial use or licensing, please contact:

ğŸ“§ **waltermsg@gmail.com**

## ğŸ“„ Legal Notice

See the `LICENSE.txt` file for full terms of use.
